<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Chapter 03. ICA Decomposing | Letswave for documentation</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="documentation-theme-jekyll" href="http://localhost:4000feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Letswave</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                
                
                <li><a href="news">News</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/NOCIONS/letswave7" target="_blank">Github Repo</a></li>
                        
                        
                        
                        <li><a href="http://letswave.cn" target="_blank">Mirror site</a></li>
                        
                        
                        
                        <li><a href="https://github.com/NOCIONS/letswave6" target="_blank">Letswave6</a></li>
                        
                        
                        
                        <li><a href="http://www.nocions.org/" target="_blank">Nocions Lab</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:huanggan1982@gmail.com?subject=Jekyll documentation theme feedback&body=I have some feedback about the Chapter 03. ICA Decomposing page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Chapter 03. ICA Decomposing">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          













<ul id="mysidebar" class="nav" media="print">
    <li class="sidebarTitle"> </li>
    
    
    
        
    
    <li>
        <a href="#">Getting Started</a>
        <ul>
            
            
            
            <li><a href="index.html">1. Welcome to Letswave</a></li>
            
            
            
            
            
            
            <li><a href="gs_general_info.html">2. General Information</a></li>
            
            
            
            
            
            
            <li><a href="gs_download_and_installation.html">3. Download and Installation</a></li>
            
            
            
            
            
            
            <li><a href="gs_framework.html">4. Letswave Framework</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Lestwave Wiki</a>
        <ul>
            
            
            
            <li><a href="wk_all_docs.html">1. All Documents</a></li>
            
            
            
            
            
            
            <li><a href="wk_LW_manager.html">2. Manager Module</a></li>
            
            
            
            
            
            
            <li><a href="wk_LW_batch.html">3. Batch Module</a></li>
            
            
            
            
            
            
            <li><a href="wk_data_structure.html">4. Data structures</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Letswave Tutorial</a>
        <ul>
            
            
            
            <li><a href="tu_getting_started.html">0. Getting Started</a></li>
            
            
            
            
            
            
            <li><a href="tu_signal_subject.html">1. Signal Subject</a></li>
            
            
            
            
            
            
            <li><a href="tu_multiple_subject.html">2. Multiple Subject</a></li>
            
            
            
            
            
            
            <li><a href="tu_multiple_subject.html">3. Figure Genertaion</a></li>
            
            
            
            
            
            
            <li><a href="tu_multiple_subject.html">4. Script Writing</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Single Subject Analysis</a>
        <ul>
            
            
            
            <li><a href="tu_chapter01.html">01. Data Import</a></li>
            
            
            
            
            
            
            <li><a href="tu_chapter02.html">02. Preprocessing</a></li>
            
            
            
            
            
            
            <li class="active"><a href="tu_chapter03.html">03. ICA Decomposing</a></li>
            
            
            
            
            
            
            <li><a href="tu_chapter04.html">04. Time Domain Analysis</a></li>
            
            
            
            
            
            
            <li><a href="tu_chapter05.html">05. Time-Frequency Analysis</a></li>
            
            
            
            
            
            
            <li><a href="tu_chapter06.html">06. Result Observation</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">Chapter 03. ICA Decomposing</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    

  <h2 id="theory-and-model-of-icabss">Theory and Model of ICA/BSS</h2>
<p>Independent Component Analysis (ICA) is a kind of Blind Signal Separation (BSS) method. Linearly, ICA can be modeled as following figure<br />
<img src="images/tu_chapter03/Fig001.png" alt="ICA Princple" /></p>

<p>Consider <strong>X</strong> is the recorded EEG signal with the dimension <em>channel</em> × <em>time</em>, <strong>S</strong> is the source signal with the dimension <em>component</em> × <em>time</em>, <strong>A</strong> is the mixing matrix with the dimension <em>channel</em> × <em>component</em>. The aim of ICA is to find the mixing matrix <strong>A</strong> to make each component (each row) to be indenpendent of each other. According to the linear model, we use ICA for artifact removing in EEG signal processing by follow steps</p>
<ol>
  <li>Run ICA algorithm to get the mixing matrix <strong>A</strong></li>
  <li>Automatically, we can have the source signal <strong>S = pinv(A) × X</strong>;</li>
  <li>Indentify the artifact component manually in <strong>S</strong>. By setting the corresponding row as <strong>0</strong>, we have <strong>S_bar</strong>;</li>
  <li>By <strong>S_bar</strong> with the artifact removed, we can automatically get <strong>X_bar = A × S_bar</strong>.</li>
</ol>

<p>The signal <strong>X_bar</strong> is the result by ICA artifact removal. In Letswave7, step 2 and 4 can be completed automatically, in which <strong>pinv(A)</strong>, also called unmixing matrix, is the pseudo inverse matrix for matrix <strong>A</strong>. Step 1 (computer ICA matrix) and step 3 (identify artifact component) need to be performed manually. Hence, in Letswave7, we need two steps to finish the work of artifact removal by ICA.</p>

<h2 id="step-5-computer-ica-matrix">Step 5. Computer ICA Matrix</h2>
<p>Select the dataset “<strong><em>chan_interp butt sel_chan sub093</em></strong>”” in the data list of the manager module, and click <strong>Process-&gt;Spatial filters(ICA/PCA)-&gt;Computer ICA matrix</strong> in the menu. In the batch module, select number of components as <strong><em>deside by user</em></strong> and set the Components Numbers as <strong>40</strong>. Click the button <strong>Run</strong> for the bad electrodes interpolation. A new dataset with the name “<strong><em>ica chan_interp butt sel_chan sub093</em></strong>” will be appeared in the data list of the manager module.<br />
<img src="images/tu_chapter03/Fig023.png" alt="Computer ICA Matrix" /></p>

<h2 id="step-6-identify-artifact-component">Step 6. Identify Artifact Component</h2>
<p>After we otain the ICA matrix, the mixing matrix <strong>A</strong> and the unmixing matrix <strong>pinv(A)</strong>, we need to identify the components with artifact manually.</p>

<p>Select the dataset “<strong><em>ica chan_interp butt sel_chan sub093</em></strong>”” in the data list of the manager module, and click <strong>Process-&gt;Spatial filters(ICA/PCA)-&gt;Apply ICA/PCA spatial filter</strong> in the menu. We will see the interface for manually reomve component for spatial filter.</p>

<p>In this interface, different information are marked by different colors. The black color represents the original signal <strong>X</strong>, color blue for source <strong>S</strong>, and color orange for the filtered signal <strong>X_bar</strong>. With the list box in black in the left panel, we can select the dataset, epoch, and channel to check the origial signal <strong>X</strong> as the black curve in the middle panel. Next, we can select the component in blue in the left panel to check the time/frequency/spatial feature of the each component in source <strong>S</strong> in the bottom panel in blue. After we identify the component as the artifact, we can select them in the right panel in orange. Correspondingly, the orange curve in the middle panel would show the filtered signal <strong>X_bar</strong>. We can check the reuslt of ICA filter immediately.</p>

<p>In this study, we can identify <strong>component 1</strong> as the eye blink artifact. The scalp topography suggest the “equivalent current dipole” (ECD)s close to the eyes. The waveform in the time domain like a spike and the power in the frequency domain concentrates at low frequency band (&lt;5Hz) both suggest this independent component as the eye blink artifact. After we remove this component by select <strong>comp 1</strong> in the right panel, the blink artifact has been effectivly removed as compared the orange curve <strong>X_bar</strong> with the black curve <strong>X</strong> in the middle panel. Similarly, <strong>component 2</strong> as the artifact with lateral eye movement. The clear evidence can be observed from the scalp topography.</p>

<p>Select <strong>comp 1</strong>, <strong>comp 2</strong> in the right panel in orange color and click the button <strong>OK</strong>. A new dataset with the name “<strong><em>sp_filter ica chan_interp butt sel_chan sub093</em></strong>” will be appeared in the data list of the manager module, which is result of artifact removing by ICA.<br />
<img src="images/tu_chapter03/Fig025.png" alt="Identify Artifact Component" />
<img src="images/tu_chapter03/Fig026.png" alt="Identify Artifact Component" /></p>

<h2 id="discussion">Discussion</h2>
<p>For running the ICA in Letswave7, there are several things need to be discussed.</p>
<ol>
  <li>Labeling independent components is an empirical work. For some components, it is clear to be identified. However, for some components it may contain both signal and noise. Each person may has his/her own view about the principle in rejecting the independent components. Some people may be radical, who  reject all the components that whenever possible to contain artifacts. Contrary to this, some person would be conservative. They only reject the components that has been identified 100% to be artifact. In this manual, we does not discuss which principle is more reasonable. Some tutorials can help you to learn how to identify the ICA component. Click <a href="https://labeling.ucsd.edu/tutorial/labels">here</a> to visit.</li>
  <li>In the menu, there are two items for ICA matrix computering, which are <strong>Computer ICA matrix</strong> and <strong>Computer ICA matrix (merged)</strong>. They have similar function, but are different in input and output. If multiple dataset has been selected, <strong>Computer ICA matrix</strong>  will computer the ICA matrix separately. However, with <strong>Computer ICA matrix (merged)</strong>, Letswave7 firstly merged all the selected datasets together, and then computer a common ICA matrix for all the datasets.</li>
  <li>The order for the operation of ICA and segmentation should also be discussed in preprocessing. Since ICA is a data driven methods for artifact removal, we need enough data to run ICA. While, excessive amount of data can greatly increase computing time, but the improvement of the accuracy in the result is limited. Normally, we run the ICA after segmentation, since segmentation could shorten the data length and remove irrelevant noises. However, in this case of the P300 study, the overlap amonge trials is very serious, running ICA after segmentation would unnecessarily increase calculation time. Hence we run ICA before segmentation.</li>
  <li>In this case, we run the ICA by selecting the number of the components as <strong>40</strong>. Normally, the maximum number of independent components that can be separated is equal to number of channels in the original signal <strong>X</strong>. If <strong>X</strong> has been referenced, the maximum number should minus 1. For each channel has been interpolated, the maximum number should minus 1 again. In addition, decreasing the number of independent components to separate is a way to reduce the computing time for the ICA matrix. In this case, since the channel number 64 is large enough, we set the number of independent components as 40 is OK.</li>
  <li>Since the computing of ICA matrix is time comsuming, several way could shorten the time for computing ICA matrix. In addition to reducing the component number for separating, downsampling would be another effective way. In this case, the sampling rate is 1000Hz. For ICA matrix computing, you can  downsample the dataset to 100Hz by selecting <strong>Edit-&gt;Resample Signals-&gt;Downsample signals (integer ratio)</strong> in the menu. Once you already have the ICA matrix from the downsampled data, you can assign the ICA matrix to the dataset before downsampling by selecting <strong>Process-&gt;Spatial filters(ICA/PCA)-&gt;Assign ICA/PCA Matrix</strong> operation in the menu. After assigning the matrix, we can similarly to indetify the components with artifact by selecting <strong>Process-&gt;Spatial filters(ICA/PCA)-&gt;Apply ICA/PCA spatial filter</strong> in the menu.</li>
</ol>


    <div class="tags">
        
    </div>

    

</div>

<hr class="shaded"/>

<footer>
        <div class="row">
            <div class="col-lg-12 footer">
               <a href="https://pages.coding.me"><img src="images/CodingPage_small.png" alt="Company logo"/></a>
               
               <span style="display:inline-block;" >
               	&copy;2018 Lestwave.cn. All rights reserved.<br />
				 Site last generated: Aug 31, 2018<br/>
				</span>
                </div>
        </div>
</footer>


    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

</body>

</html>