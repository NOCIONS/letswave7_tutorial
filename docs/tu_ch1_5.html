<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Chapter 1-5. Time-Frequency Analysis | Letswave.cn</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://localhost:4000/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Letswave7</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://github.com/NOCIONS/letswave7" target="_blank">Download</a></li>
                
                
                
                <li><a href="news">News</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:huanggan1982@gmail.com?subject=Question for Letswave feedback&body=I have some feedback about the Chapter 1-5. Time-Frequency Analysis page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Chapter 1-5. Time-Frequency Analysis">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle"> </li>
  
  
  
      
  
  <li>
      <a href="#">Overview</a>
      <ul>
          
          
          
          <li><a href="index.html">1. Welcome to Letswave</a></li>
          
          
          
          
          
          
          <li><a href="gs_general_info.html">2. General Information</a></li>
          
          
          
          
          
          
          <li><a href="gs_download_and_installation.html">3. Download and Installation</a></li>
          
          
          
          
          
          
          <li><a href="gs_framework.html">4. Letswave Framework</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Letswave Tutorial</a>
      <ul>
          
          
          
          <li><a href="tu_ch0_getting_started.html"><b>0. Getting Started</b></a></li>
          
          
          
          
          
          
          <li><a href="tu_ch1_signal_subject.html"><b>1. Signal Subject</b></a></li>
          
          
          
          
          
          
          <li><a href="tu_ch1_1.html">1.1. Data Import</a></li>
          
          
          
          
          
          
          <li><a href="tu_ch1_2.html">1.2. Preprocessing</a></li>
          
          
          
          
          
          
          <li><a href="tu_ch1_3.html">1.3. ICA Decomposing</a></li>
          
          
          
          
          
          
          <li><a href="tu_ch1_4.html">1.4. Time Domain Analysis</a></li>
          
          
          
          
          
          
          <li class="active"><a href="tu_ch1_5.html">1.5. Time-Frequency Analysis</a></li>
          
          
          
          
          
          
          <li><a href="tu_ch2_multiple_subject.html"><b>2. Multiple Subject</b></a></li>
          
          
          
          
          
          
          <li><a href="tu_ch2_1.html">2.1. Grand Average</a></li>
          
          
          
          
          
          
          <li><a href="tu_ch2_2.html">2.2. Statistical Analysis</a></li>
          
          
          
          
          
          
          <li><a href="tu_ch3_figure_genertaion.html"><b>3. Figure Genertaion</b></a></li>
          
          
          
          
          
          
          <li><a href="tu_ch3_1.html">3.1. Single Subject Result</a></li>
          
          
          
          
          
          
          <li><a href="tu_ch3_2.html">3.2. Multiple Subjects Result</a></li>
          
          
          
          
          
          
          <li><a href="tu_ch4_batch_script.html"><b>4. Batch Processing and Script</b></a></li>
          
          
          
          
          
          
          <li><a href="tu_ch4_1.html">4.1. Assign Batch Processing</a></li>
          
          
          
          
          
          
          <li><a href="tu_ch4_2.html">4.2. Run Batch Processing</a></li>
          
          
          
          
          
          
          <li><a href="tu_ch4_3.html">4.3. Script Generation</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Chapter 1-5. Time-Frequency Analysis</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    


    


    

  <h2 id="general-information">General Information</h2>
<p>Time frequency decomposition describes the change of the non-stationary EEG signal in frequency domain with the increase of time. Letswave7 provides two ways for time-frequency analysis, which are STFT (short time Fourier transform) and CWT (continues wavelets transform). STFT is compute the Fourier transform separately on each shorter segment. Hence the window length for each frequency band is the same in the STFT, which would be too short to have an accurate estimation in the lower frequency band but too long for the high frequency band to catch the nonstationary activity. Different for STFT, CWT uses different window length for different frequency band. Hence, CWT would have both good frequency resoluation for low frequency activity, and good time resoluation for high regruency activity. <br />
<img src="images/tu_ch1_5/STFT_CWT.png" alt="STFT_CWT" /></p>

<p>Normally, we can do the time frequency analysis before or after the time domain averaging. For time frequency decomposition before the time domain averaging, the non-phase-locked activity could be observed, but the signal would be more noise. The time frequency decomposition after the time domain averaging normally have a better signal noise ration, but the non-phase-locked activity will be lost.</p>

<h2 id="step-12-continous-wavelet-transform">Step 12: Continous Wavelet Transform</h2>
<p>Here, we will show the use of CWT for time frequency analysis before the time domain averaging. Select the datasets “<strong><em>bl reref ep_S  9 sp_filter ica chan_interp butt sel_chan sub093</em></strong>” and “<strong><em>bl reref ep_S 10 sp_filter ica chan_interp butt sel_chan sub093</em></strong>”, and click <strong>Plugins-&gt;my_tfa-&gt;Averaged CWT</strong> in the menu. Keep the dafault parameter setting in the batch module, and click the button <strong>Run</strong> in the bottom of batch module for the time frequency analysis. Two new datasets with the name “<strong><em>avg cwt bl reref ep_S  9 sp_filter ica chan_interp butt sel_chan sub093</em></strong>” and “<strong><em>avg cwt bl reref ep_S 10 sp_filter ica chan_interp butt sel_chan sub093</em></strong>” will be appeared in the data list of the manager module.<br />
<img src="images/tu_ch1_5/Fig048.png" alt="CWT" /></p>

<p>In fact, the operation of <strong>Plugins-&gt;my_tfa-&gt;Averaged CWT</strong> combines the steps of CWT and averaging together, which can be performed by <strong>Process-&gt;Frequency analysis and filters-&gt;CWT (Continous Wavelet Transform)</strong>, and <strong>Process-&gt;Average-&gt;Compute averag, std, median across epochs</strong> respectively
in the menu. Since the time frequency analysis is time consuming and also need a larger space for storage, the computer with small memory would be easy go to the error of “out of memory”. Hence we combine the steps of time frequency analysis and averaging together for saving the storage space.</p>

<h2 id="step-13-baseline-correction">Step 13: Baseline Correction</h2>
<p>After the time frequency analysis, we also need to do the baseline correction time-frequency domain as it is in time domain. Select the datasets <strong>avg cwt bl reref ep_S  9 sp_filter ica chan_interp butt sel_chan sub093</strong><em>” and “</em><strong>avg cwt bl reref ep_S 10 sp_filter ica chan_interp butt sel_chan sub093</strong><em>”, and click <strong>Process-&gt;Baseline operation-&gt;Baseline correction</strong> in the menu. 
It is suggest to shrink the inverval for baseline correction in time-frequency domain. Hence, we set the <strong>-0.75</strong> to <strong>-0.25</strong> seconds as the baseline  in the bacth module. In time-frequency domain, several methods, like , can be used as baseline correction. Here, we use the default method, substraction.
Click the button <strong>Run</strong> in the bottom of batch module for baseline correction. Two new datasets with the name “</em><strong>bl avg cwt bl reref ep_S  9 sp_filter ica chan_interp butt sel_chan sub093</strong><em>” and “</em><strong>bl avg cwt bl reref ep_S 10 sp_filter ica chan_interp butt sel_chan sub093</strong>*” will be appeared in the data list of the manager module.<br />
<img src="images/tu_ch1_5/Fig049.png" alt="Baseline Correction" /></p>

<h2 id="view-the-result">View the Result</h2>
<p>Select datasets “<strong><em>bl avg cwt bl reref ep_S  9 sp_filter ica chan_interp butt sel_chan sub093</em></strong>” and “<strong><em>bl avg cwt  bl reref ep_S 10 sp_filter ica chan_interp butt sel_chan sub093</em></strong>”. Click the <strong>view</strong> in the right-click menu, we can see the time frequency domain result in the multiviewer for the waveform.</p>

<p>Set the separate graphs(columns) as <strong>datasets</strong>, select both the two datasets, select channel <strong>Pz</strong>, and set color range from <strong>-10</strong> to <strong>10</strong>, we can see the result of P300 on Pz in time-frequency domain.</p>

<p>Open the topography and set the cursor to <strong>x=0.35</strong>, and <strong>y=3</strong>, we can observe the phase-locked P300 activity on the topography. Set the cursor to <strong>x=1</strong>, and <strong>y=4</strong>, the topography of a Event Related Desynchronization (ERD) acticity can be observated, which is a non-phase-locked response. 
<br />
<img src="images/tu_ch1_5/Fig051.png" alt="Time-Frequency Domain Result1" /></p>

<p><img src="images/tu_ch1_5/Fig052.png" alt="Time-Frequency Domain Result2" /></p>

<p><br /></p>

<p>Until now, we finised the tutorial on the single subject analysis. For the multiple subject analysis, see the next part of tutorial.</p>



    <div class="tags">
        
    </div>




</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2018 Letswave.cn. All rights reserved. <br />
 Site last generated: Sep 9, 2018 <br />
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-20762787-5','auto');ga('require','displayfeatures');ga('send','pageview');</script>


</html>
